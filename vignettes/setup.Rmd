---
title: "Getting set up with tidytags"
output: 
  rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting set up with tidytags}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = FALSE, comment = "#>", collapse = TRUE)
```

This vignette introduces the initial setup necessary to use {tidytags}. Specifically, attention is given to three API secret keys needed for {tidytags} functions.

Setup checklist:

1. Make sure your TAGS tracker is public and published
2. Get and store a Twitter API key
3. Get and store a Google Geocoding API key

## 1. Make sure your TAGS tracker is public and published

A core functionality of {tidytags} is collecting tweets continuously with a [Twitter Archiving Google Sheet](https://tags.hawksey.info/) (TAGS). Be sure to read through the information on  the [TAGS landing page](https://tags.hawksey.info/get-tags/) for thorough instructions on getting started with TAGS.

We recommend using **TAGS v6.1**. 

<p align="center"><img src="files/choice-TAGS-version.png" width="480"></p>

You will be prompted to `Make a copy` of TAGS that will then reside in your own Google Drive space. Click the button to do this.

<p align="center"><img src="files/TAGS-make-copy.png" width="360"></p>

Your TAGS tracker is now ready to use!

<p align="center"><img src="files/TAGS-ready.png" alt="tags tracker screenshot" width="360"></p>

{tidytags} accesses a TAGS tracker using the [{googlesheets4} package](https://CRAN.R-project.org/package=googlesheets4). One requirement for using {googlesheets4} is that your TAGS tracker has been "published to the web." To do this, with the TAGS page open in a web browser, go to `File >> Publish to the web`. 

<p align="center"><img src="files/publish-to-web-menu.png" alt="publish-to-web-menu" width="360"></p>

The `Link` field should be 'Entire document' and the `Embed` field should be 'Web page.' If everything looks right, then click the `Publish` button. 

<p align="center"><img src="files/publish-to-web-choices.png" alt="publish-to-web-choices" width="480"></p>

Next, click the `Share` button in the top right corner of the Google Sheets window, select `Get shareable link`, and set the permissions to 'Anyone with the link can view.' 

<p align="center"><img src="files/share-button.png" alt="share-button" width="480"></p>

<p align="center"><img src="files/share-anyone-with-link.png" alt="share-anyone-with-link" width="480"></p>

The input needed for the `tidytags::read_tags()` function is either the entire URL from the top of the web browser when opened to a TAGS tracker, or a Google Sheet identifier (i.e., the alphanumeric string following "https://docs.google.com/spreadsheets/d/" in the TAGS tracker's URL). 

<p align="center"><img src="files/TAGS-identifier-from-browser.png" alt="TAGS-identifier-from-browser" width="480"></p>

<p align="center"><img src="files/TAGS-identifier-highlighted.png" alt="TAGS-identifier-highlighted" width="480"></p>

Be sure to put quotations marks around the URL or sheet identifier when entering it into `read_tags()` function. For example:

`read_tags("18clYlQeJOc6W5QRuSlJ6_v3snqKJImFhU42bRkM_OX8")`.

## 2. Get and store a Twitter API key

https://developer.twitter.com/en/apply-for-access

Keep in mind that {tidytags} allows you to work with a [Twitter Archiving Google Sheet](https://tags.hawksey.info/) (TAGS) in R. 

https://docs.ropensci.org/rtweet/articles/auth.html

With a TAGS archive imported into R, {tidytags} allows you to gather quite a bit more information related to the collected tweets with the `pull_tweet_data()` function. This function uses the [{rtweet} package](https://rtweet.info/) (via `rtweet::lookup_statuses()`) to query the Twitter API. Using {rtweet} requires Twitter API keys associated with an approved developer account. Fortunately, the {rtweet} vignette, [Obtaining and using access tokens](https://rtweet.info/articles/auth.html), provides a very thorough guide to obtaining Twitter API keys. We recommend the second suggested method listed in the {rtweet} vignette, **2. Access token/secret method.** 

Following these directions, you will run the `rtweet::create_token()` function, which saves your Twitter API keys to the `.Renviron` file. You can also edit this file directly using the `usethis::edit_r_environ(scope='user')` function.




## 3. Get and store a Google Geocoding API key (optional)

The {tidytags} function `geocode_tags()` pulls from the Google Geocoding API, which requires a Google Geocoding API Key. You can easily secure a key through Google Cloud Platform; [read more here](https://developers.google.com/maps/documentation/geocoding/get-api-key). We recommend saving your Google Geocoding API Key in the `.Renviron` file as **Google_API_key**. You can quickly access this file using the R code `usethis::edit_r_environ(scope='user')`. Add a line to this file that reads: `Google_API_key="PasteYourGoogleKeyInsideTheseQuotes"`. To read your key into R, use the code `Sys.getenv('Google_API_key')`. Note that the `geocode_tags()` function retrieves your saved API key automatically and securely.

```{r edit-r-environ}
usethis::edit_r_environ(scope='user')
```

Once you've saved this file, quit your R session and restart. The function `geocode_tags()` will work for you from now on. 


```{r session, include = FALSE}
devtools::session_info()
```
